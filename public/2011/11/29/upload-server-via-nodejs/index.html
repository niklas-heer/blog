<!DOCTYPE html>



 <html class="no-js"> 
<head>
    <title>Upload-Server via NodeJS &middot; Niklas&#39; Blog</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-language" content="en-us" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Niklas Heer">
    <meta name="description" content="My personal blog.">
    <meta name="generator" content="Hugo 0.14" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="http://localhost:1313/css/main.css" />

    <link rel="stylesheet" type="text/css" href="http://localhost:1313/css/font-awesome.min.css" />
    <link href='http://fonts.googleapis.com/css?family=Raleway:400,300,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
</head>
<body>
    
    <div class="off-canvas">
    <figure class="avatar">
        <img src="http://localhost:1313/img/avatar.jpg" title="Niklas Heer">
    </figure>
    <div class="bio">
        
        <h1>Hi, I&#39;m Niklas Heer.</h1>
        
        
        <p>I love to write stuff about things that grab my attention!</p>
        
    </div>
    <nav>
        
        <h6>Subscribe</h6>
        

        <ul>
            <li><a target="_blank" href="http://localhost:1313/index.xml">RSS feed</a></li>
        </ul>

        
        <h6>Follow me on</h6>
        

        <ul>
        
            <li><a target="_blank" href="//github.com/niklas-heer">Github</a></li>
        
            <li><a target="_blank" href="//twitter.com/niklas_heer">Twitter</a></li>
        
        </ul>

        
        <h6>Other interesting sites</h6>
        

        <ul>
        
            <li><a target="_blank" href="http://nheer.io">About me</a></li>
        
            <li><a target="_blank" href="https://linux-statt-windows.org">Linux statt Windows</a></li>
        
        </ul>      
    </nav>
</div>

    <div class="site-wrapper">
        <header>
	<div class="h-wrap">
		
		<h1 class="title"><a href="http://localhost:1313/">Niklas&#39; Blog</a></h1>
		
		<a class="menu-icon" title="Menu"><span class="lines"></span></a>
	</div>
</header>
        
        <section class="single-wrap">
            <article class="single-content" itemscope itemtype="//schema.org/BlogPosting">
                <div class="feat">
                    <h5 class="page-date">
                    <time datetime="" itemprop="datePublished">
                    11. November 2011
                    </time>                  
                    </h5>
                    
                </div>
                <div class="feat-sub">
                    <span class="post-reading-time">
                        <i class="fa fa-clock-o"></i>
                        Reading time ~ 2 Min
                    </span>
                </div>
                <h1 class="page-title" itemprop="name headline">Upload-Server via NodeJS</h1>
                <div itemprop="articleBody">
                    <p>Ich hab hier mal einen Upload-Server geschrieben.</p>

<p>Er funktioniert (getestet unter Ubuntu-1104-natty-64-minimal) soweit.</p>

<p>Folgende Plugins werden verwendet: <a href="https://github.com/felixge/node-formidable">formidable</a></p>

<p>Folgendes ist unklar:</p>

<ul>
<li>funktionieren Mehrere Uploads gleichzeitig?</li>
<li>Wie kann man ein Upload-Status-Balken einbinden?</li>
</ul>

<p>Also starte ich hier einfach mal einen Aufruf!
Wer mit mir zusammen ein Projekt starten möchte (Git und SVN-Repo kann ich stellen) der möge sich bitte durch einen Kommentar hierzu melden!</p>

<p>Ansonsten unterliegt der Code hier der GNU/GPL 3!</p>

<pre><code>// Code unterliegt der GNU/GPL 3
// Autor: Niklas Heer
 
require('../test/common');
var http = require('http'),
    util = require('util'),
    formidable = require('./formidable'),
    server;
 
server = http.createServer(function(req, res) {
  if (req.url == '/') {
    res.writeHead(200, {'content-type': 'text/html'});
 
          // HTML
          res.write(
              '&amp;lt;style&amp;gt;'+
                  '#progress_bar {'+
                'margin: 10px 0;'+
                'padding: 3px;'+
                'border: 1px solid #000;'+
                'font-size: 14px;'+
                'clear: both;'+
                'opacity: 0;'+
                '-moz-transition: opacity 1s linear;'+
                    '-o-transition: opacity 1s linear;'+
                    '-webkit-transition: opacity 1s linear;'+
                    '}'+
                    '#progress_bar.loading {'+
                    'opacity: 1.0;'+
                    '}'+
                    '#progress_bar .percent {'+
                    'background-color: #99ccff;'+
                    'height: auto;'+
                    'width: 0;'+
                    '}'+
                    '&amp;lt;/style&amp;gt;'
                    );              
 
    res.end(
        '&amp;lt;h1&amp;gt; File Upload &amp;lt;/h1&amp;gt;'+
      '&amp;lt;form action=&quot;/upload&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&amp;gt;'+
      '&amp;lt;input type=&quot;text&quot; name=&quot;title&quot;&amp;gt;&amp;lt;br&amp;gt;'+
      '&amp;lt;input type=&quot;file&quot; name=&quot;upload&quot; multiple=&quot;multiple&quot;&amp;gt;&amp;lt;br&amp;gt;'+
      '&amp;lt;input type=&quot;submit&quot; value=&quot;Upload&quot;&amp;gt;'+
      '&amp;lt;/form&amp;gt;'
    );
 
  } else if (req.url == '/upload') {
    var form = new formidable.IncomingForm(),
        files = [],
        fields = [];
 
    form.uploadDir = '/home/root/node/testing/TEST_TMP';
        form.keepExtensions = true;
 
    form
 
      .on('field', function(field, value) {
        console.log(field, value);
        fields.push([field, value]);
      })
      .on('progress', function(recieved, total) {
          var progress = parseInt((recieved / total) * 100);
          var mb =(total / 1024 / 1024).toFixed(1);
 
          // Printing to screen
          util.print(&quot;Uploading &quot;+mb+&quot;mb (&quot;+progress+&quot;%)\015&quot;);
      })
 
      .on('file', function(field, file) {
        console.log(field, file);
        files.push([field, file]);
      })
      .on('end', function() {
        console.log('-&amp;gt; upload done');
        res.writeHead(200, {'content-type': 'text/plain'});
        res.write('received fields:\n\n '+util.inspect(fields));
        res.write('\n\n');
        res.end('received files:\n\n '+util.inspect(files));
      });
    form.parse(req);
  } else {
    res.writeHead(404, {'content-type': 'text/plain'});
    res.end('404');
  }
});
server.listen(1337);
 
console.log('listening on http://we-host.de/');
</code></pre>

                </div>
                <div class="feat share">
                    <a href="//twitter.com/share" class="popup">
                        <span class="icon-twitter"></span>
                    </a>
                </div>
                
                
                    <section class="disqus">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	var disqus_shortname = 'niklas_heer';
	var disqus_developer = 0; 
	(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
                

                
                
                    <a rel="next" href="http://localhost:1313/2011/11/28/4-chord-song" id="next">
                        <span class="nav-title nav-title-next">Older</span> &rarr;
                    </a>
                
                
                    <a rel="prev" href="http://localhost:1313/2011/12/05/the-animals-house-of-the-rising-sun-old-school-computer-remix" id="prev">
                        &larr; <span class="nav-title nav-title-prev">Newer</span>
                    </a>
                
            </article>
        </section>

        <footer>
	
	<small>© Niklas Heer</small>
	
</footer>
    </div>
    
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="http://localhost:1313/js/main.js"></script>

<script src="http://localhost:1313/js/vendor/jquery-1.9.1.min.js"></script>
<script src="http://localhost:1313/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<script src="http://localhost:1313/js/plugins/jquery.magnific-popup.js"></script>
<script src="http://localhost:1313/js/plugins/jquery.fitvids.js"></script>




<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>