<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Nodejs on Niklas&#39; Blog</title>
    <link>http://blog.nheer.io/tags/nodejs/</link>
    <description>Recent content in Nodejs on Niklas&#39; Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 29 Nov 2011 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://blog.nheer.io/tags/nodejs/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Upload-Server via NodeJS</title>
      <link>http://blog.nheer.io/2011/11/29/upload-server-via-nodejs</link>
      <pubDate>Tue, 29 Nov 2011 00:00:00 +0000</pubDate>
      
      <guid>http://blog.nheer.io/2011/11/29/upload-server-via-nodejs</guid>
      <description>&lt;p&gt;Ich hab hier mal einen Upload-Server geschrieben.&lt;/p&gt;

&lt;p&gt;Er funktioniert (getestet unter Ubuntu-1104-natty-64-minimal) soweit.&lt;/p&gt;

&lt;p&gt;Folgende Plugins werden verwendet: &lt;a href=&#34;https://github.com/felixge/node-formidable&#34;&gt;formidable&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Folgendes ist unklar:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;funktionieren Mehrere Uploads gleichzeitig?&lt;/li&gt;
&lt;li&gt;Wie kann man ein Upload-Status-Balken einbinden?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Also starte ich hier einfach mal einen Aufruf!
Wer mit mir zusammen ein Projekt starten möchte (Git und SVN-Repo kann ich stellen) der möge sich bitte durch einen Kommentar hierzu melden!&lt;/p&gt;

&lt;p&gt;Ansonsten unterliegt der Code hier der GNU/GPL 3!&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;// Code unterliegt der GNU/GPL 3
// Autor: Niklas Heer
 
require(&#39;../test/common&#39;);
var http = require(&#39;http&#39;),
    util = require(&#39;util&#39;),
    formidable = require(&#39;./formidable&#39;),
    server;
 
server = http.createServer(function(req, res) {
  if (req.url == &#39;/&#39;) {
    res.writeHead(200, {&#39;content-type&#39;: &#39;text/html&#39;});
 
          // HTML
          res.write(
              &#39;&amp;amp;lt;style&amp;amp;gt;&#39;+
                  &#39;#progress_bar {&#39;+
                &#39;margin: 10px 0;&#39;+
                &#39;padding: 3px;&#39;+
                &#39;border: 1px solid #000;&#39;+
                &#39;font-size: 14px;&#39;+
                &#39;clear: both;&#39;+
                &#39;opacity: 0;&#39;+
                &#39;-moz-transition: opacity 1s linear;&#39;+
                    &#39;-o-transition: opacity 1s linear;&#39;+
                    &#39;-webkit-transition: opacity 1s linear;&#39;+
                    &#39;}&#39;+
                    &#39;#progress_bar.loading {&#39;+
                    &#39;opacity: 1.0;&#39;+
                    &#39;}&#39;+
                    &#39;#progress_bar .percent {&#39;+
                    &#39;background-color: #99ccff;&#39;+
                    &#39;height: auto;&#39;+
                    &#39;width: 0;&#39;+
                    &#39;}&#39;+
                    &#39;&amp;amp;lt;/style&amp;amp;gt;&#39;
                    );              
 
    res.end(
        &#39;&amp;amp;lt;h1&amp;amp;gt; File Upload &amp;amp;lt;/h1&amp;amp;gt;&#39;+
      &#39;&amp;amp;lt;form action=&amp;quot;/upload&amp;quot; enctype=&amp;quot;multipart/form-data&amp;quot; method=&amp;quot;post&amp;quot;&amp;amp;gt;&#39;+
      &#39;&amp;amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;title&amp;quot;&amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;&#39;+
      &#39;&amp;amp;lt;input type=&amp;quot;file&amp;quot; name=&amp;quot;upload&amp;quot; multiple=&amp;quot;multiple&amp;quot;&amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;&#39;+
      &#39;&amp;amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;Upload&amp;quot;&amp;amp;gt;&#39;+
      &#39;&amp;amp;lt;/form&amp;amp;gt;&#39;
    );
 
  } else if (req.url == &#39;/upload&#39;) {
    var form = new formidable.IncomingForm(),
        files = [],
        fields = [];
 
    form.uploadDir = &#39;/home/root/node/testing/TEST_TMP&#39;;
        form.keepExtensions = true;
 
    form
 
      .on(&#39;field&#39;, function(field, value) {
        console.log(field, value);
        fields.push([field, value]);
      })
      .on(&#39;progress&#39;, function(recieved, total) {
          var progress = parseInt((recieved / total) * 100);
          var mb =(total / 1024 / 1024).toFixed(1);
 
          // Printing to screen
          util.print(&amp;quot;Uploading &amp;quot;+mb+&amp;quot;mb (&amp;quot;+progress+&amp;quot;%)\015&amp;quot;);
      })
 
      .on(&#39;file&#39;, function(field, file) {
        console.log(field, file);
        files.push([field, file]);
      })
      .on(&#39;end&#39;, function() {
        console.log(&#39;-&amp;amp;gt; upload done&#39;);
        res.writeHead(200, {&#39;content-type&#39;: &#39;text/plain&#39;});
        res.write(&#39;received fields:\n\n &#39;+util.inspect(fields));
        res.write(&#39;\n\n&#39;);
        res.end(&#39;received files:\n\n &#39;+util.inspect(files));
      });
    form.parse(req);
  } else {
    res.writeHead(404, {&#39;content-type&#39;: &#39;text/plain&#39;});
    res.end(&#39;404&#39;);
  }
});
server.listen(1337);
 
console.log(&#39;listening on http://we-host.de/&#39;);
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>